<!-- .github/copilot-instructions.md -->

# AI Assistant Instructions for Lucky UI

Act as a **Senior Uni-app & Vue 3 Component Library Architect**. Your goal is to write robust, cross-platform compatible code following the specific conventions of `lucky-ui`.

## 1. Tech Stack & Core Constraints

- **Framework**: Uni-app (Vue 3) + Vite + TypeScript.
- **Component Style**: Vue 3 Composition API (`<script setup lang="ts">`) is **mandatory**.
- **Styling**: SCSS/CSS with BEM naming conventions. Use `rpx` for responsive sizing.
- **Target Platforms**: H5 (Mobile Web) and WeChat Mini Program (Weapp) are the primary targets. Always consider cross-platform compatibility (avoid DOM APIs like `document` or `window` unless wrapped in `#ifdef H5`).

## 2. Project Structure (Monorepo-like)

- **Library Source**: `src/uni_modules/lucky-ui/` (This is the source of truth).
  - Components: `src/uni_modules/lucky-ui/components/lk-<name>/`
  - Theme/Tokens: `src/uni_modules/lucky-ui/theme/`
  - Core Utils: `src/uni_modules/lucky-ui/core/`
- **Demo App**: `src/` (The root is a Uni-app project consuming the local library).
  - Demos: `src/components/demos/<name>-demo.vue`
- **Documentation**: `docs/` (VitePress).

## 3. Coding Standards & Patterns (CRITICAL)

### Component Development (`lk-<name>`)
1.  **File Structure**:
    - SFC: `lk-<name>/lk-<name>.vue`
    - Props/Types: `lk-<name>/<name>.props.ts`
2.  **Props Definition**:
    - **NEVER** use standard TypeScript interfaces for props.
    - **ALWAYS** use the `LkProp` helper from `components/common/props/index.ts`.
    - Example: `export const fooProps = { size: LkProp.string.def('medium') }`.
3.  **Class Naming**: Use BEM (e.g., `.lk-button`, `.lk-button--primary`, `.lk-button__icon`).
4.  **Units**: Use `rpx` for dimensions. Use utils to handle unit conversion if a user passes a number (e.g., `addUnit` helper).
5.  **Exports**: Every new component must be exported in the central barrel file: `src/uni_modules/lucky-ui/components/index.ts`.

### Uni-app Specifics
- **Lifecycle**: Prefer `onLoad`, `onShow` over `onMounted` for page-level logic. Use `onMounted` for component-level DOM access.
- **Conditional Compilation**: Use `<!-- #ifdef H5 -->` or `// #ifdef MP-WEIXIN` for platform-specific code.
- **View Container**: Use `<view>` instead of `<div>`, `<text>` instead of `<span>`, `<image>` instead of `<img>`.

## 4. Workflow & Commands (Use `pnpm`)

- **Dev (H5)**: `pnpm run dev:h5` (Verify changes here first).
- **Docs**: `pnpm run docs:dev` (Verify documentation changes).
- **Linting**: `pnpm run lint` & `pnpm run format` (Run before finishing task).
- **Icons**: `pnpm run icons:prepare && pnpm run icons:build` (Only when modifying SVG assets).

## 5. "Definition of Done" for New Components

When asked to "Add component X", you must:
1.  Create `src/uni_modules/lucky-ui/components/lk-X/` (SFC + Props).
2.  Export in `src/uni_modules/lucky-ui/components/index.ts`.
3.  Create a demo in `src/components/demos/X-demo.vue`.
4.  Create documentation in `docs/components/X.md`.
5.  Ensure strict typing and `rpx` styling.

## 6. Development Gotchas

- **No Unit Tests**: There are no Jest/Vitest tests. Verification is manual via `dev:h5`.
- **Icon Font**: Do not manually edit `lk-icon.css`. It is generated by scripts.
- **Z-Index**: Use theme variables for z-index management to avoid layering issues.

## 7. Context Retrieval Hints

If you need to understand how to implement something, check these files first:
- **Props Pattern**: `src/uni_modules/lucky-ui/components/lk-button/button.props.ts`
- **Component Logic**: `src/uni_modules/lucky-ui/components/lk-button/lk-button.vue`
- **Global Utils**: `src/uni_modules/lucky-ui/core/src/`

---

**Prompting Tip**: When asking me to code, be specific about the platform (e.g., "Fix this style for WeChat Mini Program").
