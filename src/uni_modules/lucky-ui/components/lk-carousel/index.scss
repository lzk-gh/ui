@use '../../theme/src/mixins' as *;

@include b(carousel) {
  position: relative;
  width: 100%;
  /* 确保自身是块级容器 */
  display: block;

  @include e(swiper) {
    width: 100%;
    height: 100%;
    /* 修复小程序中 swiper 某些情况下高度计算问题 */
    display: block;
  }

  /* 轮播项包裹层 */
  @include e(item-wrap) {
    width: 100%;
    height: 100%;
    transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.5, 1), opacity 0.3s ease;
    position: relative;
    box-sizing: border-box;

    @include when(auto-height) {
      height: auto;
      align-items: flex-start;
    }

    /* 卡片模式 */
    @include when(card) {
      border-radius: var(--lk-card-radius, 12rpx);
      overflow: hidden;
      backface-visibility: hidden;
      transform-origin: center center;
      /* 小程序中消除图片边缘溢出 */
      transform: translateZ(0);

      @include when(inactive) {
        transform: scale(var(--lk-card-scale, 0.9)) translateZ(0);
        opacity: 0.8;
      }

      @include when(active) {
        transform: scale(1) translateZ(0);
        opacity: 1;
        box-shadow: var(--lk-card-shadow, 0 8rpx 24rpx rgba(0,0,0,0.12));
        z-index: 1;
      }
    }
  }

  /* --- 指示器容器 (位置逻辑重构) --- */
  @include e(indicators) {
    position: absolute;
    display: flex;
    align-items: center;
    gap: 12rpx;
    z-index: 10;
    pointer-events: none;

    view { pointer-events: auto; }

    /* 垂直排列 */
    @include when(vertical) { flex-direction: column; }

    /* --- 具体位置定义 --- */

    /* 1. 底部居中 (默认) */
    @include m(pos-bottom) {
      left: 50%; bottom: 24rpx; transform: translateX(-50%);
    }
    /* 2. 顶部居中 */
    @include m(pos-top) {
      left: 50%; top: 24rpx; transform: translateX(-50%);
    }
    /* 3. 左侧垂直居中 */
    @include m(pos-left) {
      left: 24rpx; top: 50%; transform: translateY(-50%);
      flex-direction: column; /* 左侧默认垂直排列指示点 */
    }
    /* 4. 右侧垂直居中 */
    @include m(pos-right) {
      right: 24rpx; top: 50%; transform: translateY(-50%);
      flex-direction: column; /* 右侧默认垂直排列指示点 */
    }

    /* 5. 左下角 */
    @include m(pos-bottom-left) {
      left: 24rpx; bottom: 24rpx;
    }
    /* 6. 右下角 */
    @include m(pos-bottom-right) {
      right: 24rpx; bottom: 24rpx;
    }
    /* 7. 左上角 */
    @include m(pos-top-left) {
      left: 24rpx; top: 24rpx;
    }
    /* 8. 右上角 */
    @include m(pos-top-right) {
      right: 24rpx; top: 24rpx;
    }


    /* --- 外部模式 (Outside) --- */
    @include when(outside) {
      position: relative;
      transform: none; left: auto; right: auto; top: auto; bottom: auto;
      margin-top: 20rpx;
      justify-content: center;

      @include when(vertical) {
        margin: 0 0 0 20rpx;
        height: 100%;
        justify-content: center;
      }
    }

    /* 数字样式 */
    @include e(indicator-number) {
      padding: 6rpx 18rpx;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(4px);
      color: #fff;
      border-radius: 100rpx;
      font-size: 24rpx;
      font-weight: 500;
      letter-spacing: 1px;
    }
  }

  /* --- 指示器单点 (样式优化：更圆润饱满) --- */
  @include e(indicator) {
    transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
    background-color: #ebedf0;
    opacity: 0.4;

    /* 圆点：稍微大一点 */
    @include when(dot) {
      width: 14rpx;
      height: 14rpx;
      border-radius: 50%;
    }

    /* 条形：更厚实，不要太扁 */
    @include when(bar) {
      width: 26rpx;
      height: 8rpx; /* 高度增加 */
      border-radius: 100rpx;
    }

    @include when(active) {
      opacity: 1;
      background-color: #fff;

      @include when(dot) {
        transform: scale(1.2);
      }

      @include when(bar) {
        width: 44rpx; /* 激活时变长，更有张力 */
        height: 8rpx;
        background-color: #fff;
      }
    }
  }
}
