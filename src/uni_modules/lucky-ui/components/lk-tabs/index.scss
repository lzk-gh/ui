@use '../../theme/src/mixins/bem' as *;

@include b(tabs) {
  display: flex;
  flex-direction: column;
  width: 100%;
  background-color: var(--lk-color-bg-container);
  border-radius: var(--lk-radius-lg, 16rpx);
  overflow: hidden;

  /* ── 设计令牌 ─────────────────────────────── */
  --lk-tabs-nav-bg: transparent;
  --lk-tabs-active-color: var(--lk-color-primary);
  --lk-tabs-text-color: var(--lk-text-secondary);
  --lk-tabs-active-text-color: var(--lk-color-primary);
  --lk-tabs-line-height: 6rpx;
  --lk-tabs-line-radius: var(--lk-radius-full);
  --lk-tabs-font-size: var(--lk-font-size-base);
  --lk-tabs-padding: 0 24rpx;
  --lk-tabs-item-gap: 8rpx;
  --lk-tabs-header-border: 1px solid var(--lk-border-color-light, rgba(0, 0, 0, 0.06));
  --lk-tabs-fade-width: 48rpx;

  /* ── header (Tab 栏容器) ────────────────────── */
  @include e(header) {
    display: flex;
    align-items: center;
    background: var(--lk-tabs-nav-bg);
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-bottom: var(--lk-tabs-header-border);
  }

  /* ── prefix / suffix 固定区 ────────────────── */
  @include e(prefix) {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    padding-left: 24rpx;
  }

  @include e(suffix) {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    padding-right: 24rpx;
  }

  /* ── 渐变蒙层 (溢出提示) ───────────────────── */
  @include e(fade) {
    position: absolute;
    top: 0;
    bottom: 0;
    width: var(--lk-tabs-fade-width);
    z-index: 2;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.25s ease;
  }

  .lk-tabs__fade--left {
    left: 0;
    background: linear-gradient(
      to right,
      var(--lk-color-bg-container, #ffffff) 0%,
      transparent 100%
    );

    &.is-visible {
      opacity: 1;
    }
  }

  .lk-tabs__fade--right {
    right: 0;
    background: linear-gradient(
      to left,
      var(--lk-color-bg-container, #ffffff) 0%,
      transparent 100%
    );

    &.is-visible {
      opacity: 1;
    }
  }

  /* ── nav 滚动容器 ──────────────────────────── */
  @include e(nav) {
    flex: 1;
    overflow: hidden;
    white-space: nowrap;
    position: relative;

    -ms-overflow-style: none;
    scrollbar-width: none;
    &::-webkit-scrollbar {
      display: none;
      width: 0;
      height: 0;
    }
  }

  @include e(nav-wrap) {
    display: inline-flex;
    position: relative;
    min-width: 100%;
    box-sizing: border-box;
    padding: var(--lk-tabs-padding);
  }

  /* ── 单个 tab ──────────────────────────────── */
  @include e(nav-item) {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 24rpx 32rpx;
    font-size: var(--lk-tabs-font-size);
    color: var(--lk-tabs-text-color);
    cursor: pointer;
    transition:
      color 0.25s ease,
      font-weight 0.25s ease,
      background-color 0.25s ease,
      transform 0.15s ease;
    flex-shrink: 0;
    box-sizing: border-box;
    gap: var(--lk-tabs-item-gap);

    &:active {
      transform: scale(0.97);
    }

    @include when(active) {
      color: var(--lk-tabs-active-text-color);
      font-weight: 600;
    }
  }

  @include e(label) {
    position: relative;
    z-index: 1;
    line-height: 1.4;
  }

  /* ── indicator-wrap ────────────────────────── */
  @include e(indicator-wrap) {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: var(--lk-tabs-line-height);
    pointer-events: none;
  }

  /* ── 默认下划线指示器 ──────────────────────── */
  @include e(line) {
    position: absolute;
    bottom: 0;
    left: 0;
    height: var(--lk-tabs-line-height);
    background: var(--lk-tabs-active-color);
    border-radius: var(--lk-tabs-line-radius);
    transition:
      transform 0.3s cubic-bezier(0.645, 0.045, 0.355, 1),
      width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);
    z-index: 1;
    will-change: transform, width;
    transform: translateZ(0);
    backface-visibility: hidden;
  }

  /* ── card 类型 ─────────────────────────────── */
  @include m(card) {
    @include e(header) {
      border-bottom: none;
    }

    @include e(nav-wrap) {
      padding: 16rpx 24rpx;
      gap: 16rpx;
    }

    @include e(nav-item) {
      padding: 16rpx 36rpx;
      margin-right: 0;
      background-color: var(--lk-fill-1, rgba(0, 0, 0, 0.04));
      border-radius: var(--lk-radius-md, 12rpx);
      transition: all 0.25s ease;

      @include when(active) {
        background-color: var(--lk-tabs-active-color);
        color: #ffffff;
        box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);
      }
    }

    @include e(indicator-wrap) {
      display: none;
    }

    @include e(line) {
      display: none;
    }
  }

  /* ── pill 胶囊类型 ─────────────────────────── */
  @include m(pill) {
    @include e(header) {
      border-bottom: none;
    }

    @include e(nav-wrap) {
      padding: 12rpx 24rpx;
      gap: 12rpx;
      background: var(--lk-fill-1, rgba(0, 0, 0, 0.04));
      border-radius: var(--lk-radius-full, 999rpx);
      margin: 16rpx 24rpx;
    }

    @include e(nav-item) {
      padding: 14rpx 36rpx;
      margin-right: 0;
      border-radius: var(--lk-radius-full, 999rpx);
      background: transparent;
      transition: all 0.25s ease;

      @include when(active) {
        background-color: var(--lk-color-bg-container, #ffffff);
        color: var(--lk-tabs-active-text-color);
        box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.08);
      }
    }

    @include e(indicator-wrap) {
      display: none;
    }

    @include e(line) {
      display: none;
    }
  }

  /* ── stretch 拉伸 (仅 tab 少时生效) ──────── */
  &.is-stretch {
    .lk-tabs__nav-wrap {
      display: flex;
    }
    .lk-tabs__nav-item {
      flex: 1;
      padding-left: 0;
      padding-right: 0;
    }
  }

  /* ── content ───────────────────────────────── */
  @include e(content) {
    width: 100%;
    box-sizing: border-box;
    transform: translateZ(0);
    backface-visibility: hidden;
    will-change: transform;
  }
}

@include b(tab-pane) {
  width: 100%;
  box-sizing: border-box;
  transform: translateZ(0);
  backface-visibility: hidden;
}
