@use '../../theme/src/mixins/bem' as *;

@include b(textarea) {
  --_fs: var(--lk-control-font-size-md);
  --_radius: var(--lk-radius-lg);
  --_border: var(--lk-input-border-color);
  --_border-hover: var(--lk-input-border-color-hover);
  --_border-active: var(--lk-input-border-color-active);
  --_placeholder: var(--lk-input-placeholder-color);
  --_bg: var(--lk-input-bg);

  position: relative;
  width: 100%;
  background: var(--_bg);
  border: 2rpx solid var(--_border);
  border-radius: var(--_radius);
  padding: 12rpx var(--lk-control-padding-x-md) 20rpx;
  display: flex;
  flex-direction: column;
  transition:
    border-color var(--lk-duration-base),
    box-shadow var(--lk-duration-base);

  @include m(sm) {
    --_fs: var(--lk-control-font-size-sm);
    --_radius: var(--lk-radius-md);
    padding: 8rpx var(--lk-control-padding-x-sm) 16rpx;
  }

  @include m(lg) {
    --_fs: var(--lk-control-font-size-lg);
    --_radius: var(--lk-radius-pill);
    padding: 16rpx var(--lk-control-padding-x-lg) 24rpx;
  }

  @include e(inner) {
    width: 100%;
    font-size: var(--_fs);
    line-height: 1.5;
    background: transparent;
    border: none;
    resize: none;
    outline: none;
    color: var(--lk-color-text);
    min-height: 120rpx;

    &::placeholder {
      color: var(--_placeholder);
    }
  }

  @include e(clear) {
    position: absolute;
    right: 16rpx;
    top: 12rpx;
    font-size: 32rpx;
    color: var(--lk-color-text-secondary);
    padding: 8rpx;
    line-height: 1;
    border-radius: var(--lk-radius-sm);

    &:active {
      background: var(--lk-color-primary-bg-soft);
      color: var(--lk-color-primary-active);
    }
  }

  @include e(count) {
    align-self: flex-end;
    margin-top: 8rpx;
    font-size: 22rpx;
    color: var(--lk-color-text-secondary);
  }

  &:hover:not(.is-disabled):not(.is-readonly) {
    border-color: var(--_border-hover);
  }

  &:active:not(.is-disabled):not(.is-readonly) {
    border-color: var(--_border-active);
  }

  &:focus-within:not(.is-disabled):not(.is-readonly) {
    border-color: var(--_border-active);
    box-shadow: var(--lk-input-shadow-focus);
  }

  @include when(disabled) {
    opacity: 0.6;
  }

  @include when(readonly) {
    background: var(--lk-color-primary-bg-soft);
  }

  :global(.lk-form-item.is-error) & {
    border-color: var(--lk-input-border-color-error);
    box-shadow: 0 0 0 4rpx var(--lk-color-primary-bg-soft);
  }
}
